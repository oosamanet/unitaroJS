<html>
<head>
<meta charset="utf-8">
<title>UNITAROjs</title>
<link id="favicon" rel="shortcut icon" src="">
<meta name="viewport" content="width=device-width,user-scalable=no" />
<script src="../js/unitaro.js"></script>
</head>
<body style="margin:0">
<script>

var LEFTBAR={
  w:2,
  h:12,
  color:'red',
  init:function(x,y){
    this.x=x;
    this.y=y;
  },
  update:function(){
    var y = app.ball.y;
    if (y<this.h/2){
      y=this.h/2;
    }
    if (y>32-this.h/2){
      y=32-this.h/2;
    }

    if (app.ball.vx<0){
      if (this.y<y){
        this.y++;
      }
      if (this.y>y){
        this.y--;
      }
    }
  },
};

var RIGHTBAR={
  w:2,
  h:12,
  color:'red',
  init:function(x,y){
    this.x=x;
    this.y=y;
  },
  update:function(){
    var y = app.ball.y;
    if (y<this.h/2){
      y=this.h/2;
    }
    if (y>32-this.h/2){
      y=32-this.h/2;
    }

    if (app.ball.vx>0){
      if (this.y<y){
        this.y++;
      }
      if (this.y>y){
        this.y--;
      }
    }
  },
};

var BALL={
  w:2,
  h:2,

  color:'blue',
  init:function(x,y){
    this.x=x;
    this.y=y;
    this.vx=1;
    this.vy=1;
  },
  update:function(){
    if (app.ball.x<4 || app.ball.x>28){
      this.vx = -this.vx;
    }
    if (app.ball.y<4 || app.ball.y>28){
      this.vy = -this.vy;
    }
    this.x += this.vx;
    this.y += this.vy;
  },
};

var APP = {
  WIDTH: 32,
  HEIGHT: 32,
  init: function(){
    this.leftbar=new Task(LEFTBAR,1,0);
    this.rightbar=new Task(RIGHTBAR,31,20);
    this.ball=new Task(BALL,15,15);
  },
  update: function(age){
    favicon.href=Canvas.canvas.toDataURL()
    Canvas.box(0,0,this.WIDTH,this.HEIGHT,"rgb(40,40,40)");
  },
  onclick: function(x,y){
  }
};

window.addEventListener('load',function(){
  window.app = new App(APP);
},false);

</script>
</body>
</html>
